<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />

    <link rel="stylesheet" href="./css/repsoil.css" />
    <link rel="stylesheet" href="./css/dashboard2.css" />

    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
    />
   	<script src="https://apis.google.com/js/api.js"></script>
   <script>
     // Client ID and API key from the Developer Console
		var CLIENT_ID = '2d8bdb7d6fc4c4fc4326';
		var API_KEY = '2e74df4e68b0d4eedbe695f77ab9d1a6d28f6b60';

		// Array of API discovery doc URLs for APIs used by the quickstart
		var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

		// Authorization scopes required by the API; multiple scopes can be
		// included, separated by spaces.
		var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

		var authorizeButton = document.getElementById('authorize-button');
		var signoutButton = document.getElementById('signout-button');
		var data1Element = document.getElementById('data1');
		var data2Element = document.getElementById('data2');
		var data3Element = document.getElementById('data3');

		/**
		 *  On load, called to load the auth2 library and API client library.
		 */
		function handleClientLoad() {
			gapi.load('client:auth2', initClient);
		}

		/**
		 *  Initializes the API client library and sets up sign-in state
		 *  listeners.
		 */
		function initClient() {
			gapi.client.init({
				apiKey: API_KEY,
				clientId: CLIENT_ID,
				discoveryDocs: DISCOVERY_DOCS,
				scope: SCOPES
			}).then(function () {
				// Listen for sign-in state changes.
				gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

				// Handle the initial sign-in state.
				updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
			}, function (error) {
				console.error(JSON.stringify(error, null, 2));
			});
		}

		/**
		 *  Called when the signed in status changes, to update the UI
		 *  appropriately. After a sign-in, the API is called.
		 */
		function updateSigninStatus(isSignedIn) {
			if (isSignedIn) {
				// Call the Sheets API to get data from specific columns
				gapi.client.sheets.spreadsheets.values.batchGet({
					spreadsheetId: '1waWDtnICSNIqL3sY5Z9iuhrBmCRY4GXiw1tDL20knPk',
					ranges: ['Sheet1!A2:A', 'Sheet1!B2:B', 'Sheet1!C2:C'], // Change this to your specific column ranges
				}).then(function (response) {
					var data = response.result.valueRanges;

					if (data.length > 0) {
						// Extract the latest value from each column
						var latestValue1 = data[0].values[data[0].values.length - 1];
						var latestValue2 = data[1].values[data[1].values.length - 1];
						var latestValue3 = data[2].values[data[2].values.length - 1];

						// Display the latest value in the HTML text elements
						data1Element.textContent = latestValue1;
						data2Element.textContent = latestValue2;
						data3Element.textContent = latestValue3;

						// Schedule the next update
						setTimeout(updateSigninStatus, 1000);
					} else {
						console.log('No data found.');
					}
				}, function (response) {
					console.error('Error: ' + response.result.error.message);
				});
			} else {
				gapi.auth2.getAuthInstance().signIn();
			}
		}
	</script>

	<!--Sign in button-->
	<button id="authorize-button" style="display: none;">Authorize</button>

	<!--Sign out button-->
	<button id="signout-button" style="display: none;">Sign Out</button>

	<script>
		// Event listeners for the sign-in and sign-out buttons
		document.getElementById('authorize-button').addEventListener('click', function () {
			gapi.auth2.getAuthInstance().signIn();
		});

		document.getElementById('signout-button').addEventListener('click', function () {
			gapi.auth2.getAuthInstance().signOut();
		});
	</script>

	<script async defer src="https://apis.google.com/js/api.js"
	onload="this.onload=function(){};handleClientLoad()"
	onreadystatechange="if (this.readyState === 'complete') this.onload()">
	</script>
  </head>
  <body>
    <div class="desktop-2">
      <div class="search-and-profile-account-bar">
        <img
          class="entypodots-three-vertical-icon"
          alt=""
          src="./img/entypodotsthreevertical.svg"
        /><img
          class="search-and-profile-account-bar-child"
          alt=""
          src="./img/ellipse-1@2x.png"
        />
        <div class="as-shakirin">As Shakirin</div>
      </div>
      <div class="side-menu">
        <div class="side-navigation"></div>
        <div class="side-menu-child"></div>
        <img class="logo-icon" alt="" src="./img/logo.svg" />
        <div class="settings-side">
          <b class="settings">Settings</b
          ><img
            class="icon-chevron-down1"
            alt=""
            src="./img/-icon-chevron-down.svg"
          /><img class="icon-filter" alt="" src="./img/-icon-filter.svg" />
        </div>
        <div class="dashboard-side" id="dashboardSideContainer">
          <b class="dashboard">Dashboard</b
          ><img
            class="icon-chevron-down2"
            alt=""
            src="./img/-icon-chevron-down2.svg"
          /><img class="icon-grid" alt="" src="./img/-icon-grid.svg" />
        </div>
        <div class="device-side">
          <div class="device-side-child"></div>
          <b class="device">Device</b
          ><img
            class="icon-chevron-down3"
            alt=""
            src="./img/-icon-chevron-down.svg"
          /><img class="icon-mobile" alt="" src="./img/-icon-mobile.svg" />
        </div>
        <div class="data-side">
          <b class="data">Data</b
          ><img
            class="icon-chevron-down4"
            alt=""
            src="./img/-icon-chevron-down.svg"
          /><img
            class="icon-bar-chart-alt"
            alt=""
            src="./img/-icon-bar-chart-alt.svg"
          />
        </div>
        <div class="log-out">
          <b class="log-out1">Log Out</b
          ><img class="icon-log-out" alt="" src="./img/-icon-log-out.svg" />
        </div>
        <div class="help">
          <img
            class="icon-clipboard-list"
            alt=""
            src="./img/-icon-clipboard-list.svg"
          /><b class="help-getting">Help & Getting Started</b>
        </div>
      </div>
      <div class="repsoil-bar">
        <div class="repsoil-bar-child"></div>
        <div class="online">Online</div>
        <img class="repsoil-bar-item" alt="" src="./img/ellipse-2.svg" /><b
          class="temperature"
          >Temperature</b
	      ><b class="temperature-c"></b><p id="data1"></p><b class="celcius-c">Celciu (Â°C)</b
        ><img class="repsoil-bar-inner" alt="" src="./img/ellipse-4.svg" /><img
          class="mask-group-icon"
          alt=""
          src="./img/mask-group.svg"
        />
      </div>
      <div class="moisture-bar">
        <div class="repsoil-bar-child"></div>
        <div class="online">Online</div>
        <img class="repsoil-bar-item" alt="" src="./img/ellipse-2.svg" /><b
          class="temperature"
          >Moisture</b
        ><b class="temperature-c"><p id="data2"></p></b><b class="percentage">Percentage (%)</b>
        <img
          class="mask-group-icon1"
          alt=""
          src="./img/mask-group1.svg"
        /><img class="moisture-1-icon" alt="" src="./img/moisture-1.svg" />
      </div>
      <div class="ec-bar">
        <div class="repsoil-bar-child"></div>
        <div class="online">Online</div>
        <img class="repsoil-bar-item" alt="" src="./img/ellipse-2.svg" /><b
          class="temperature"
          >EC</b
	      ><b class="temperature-c"><p id="data3"></p></b>2<b class="percentage">(uS/m)</b
        ><img class="mask-group-icon1" alt="" src="./img/mask-group2.svg" />
      </div>
      <b class="device1">Device</b
      ><img class="energy-1-icon" alt="" src="./img/energy-1.svg" />
      <div class="dropdown-menu">
        <div class="dropdown-menu-child"></div>
        <img
          class="icon-chevron-down5"
          alt=""
          src="./img/-icon-chevron-down.svg"
        />
        <div class="select-repsoil">Select Repsoil</div>
        <img class="icon-computer1" alt="" src="./img/-icon-computer.svg" />
      </div>
      <div class="search-bar">
        <div class="search-bar-child"></div>
        <div class="search-using-keywords">
          Search using keywords or name ...
        </div>
        <img class="vector-icon" alt="" src="./img/vector.svg" /><img
          class="close-searchbar-icon"
          alt=""
        />
      </div>
    </div>

   
  </body>
</html>
